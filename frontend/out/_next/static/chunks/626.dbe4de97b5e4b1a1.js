(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{5695:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return WorkflowBuilder}});var s=t(7437),r=t(2265),o=t(6816),i=t(105),n=t(1611);t(9176);var l=t(9883),d=t(2882),c=t(8438),m=t(6637),u=t(481),p=t(5817),x=t(1541),f=t(3611),g=t(5487),h=t(1628);let N=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,h.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});N.displayName="Card";let j=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,h.cn)("flex flex-col space-y-1.5 p-6",t),...r})});j.displayName="CardHeader";let b=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("h3",{ref:a,className:(0,h.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});b.displayName="CardTitle";let v=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("p",{ref:a,className:(0,h.cn)("text-sm text-muted-foreground",t),...r})});v.displayName="CardDescription";let C=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,h.cn)("p-6 pt-0",t),...r})});C.displayName="CardContent";let w=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,h.cn)("flex items-center p-6 pt-0",t),...r})});w.displayName="CardFooter";var y=t(9213);let k=(0,y.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:a,variant:t,...r}=e;return(0,s.jsx)("div",{className:(0,h.cn)(k({variant:t}),a),...r})}let T=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("textarea",{className:(0,h.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...r})});T.displayName="Textarea";let BaseNode=e=>{let{data:a,icon:t,label:r,badgeText:i,children:n,updateNodeData:l,isOutput:d=!1,hideBottomHandles:c=!1,singleTarget:m=!1}=e,u="!bg-primary w-3 h-3 transition-transform hover:scale-150";return(0,s.jsxs)(N,{className:"w-[280px] bg-card/95 supports-[backdrop-filter]:bg-card/80 relative group shadow-xl border-2 hover:border-primary/50 transition-all",children:[m?(0,s.jsx)(o.HH,{type:"target",position:o.Ly.Top,className:u}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.HH,{type:"target",position:o.Ly.Top,className:"".concat(u," left-[25%]")}),(0,s.jsx)(o.HH,{type:"target",position:o.Ly.Top,className:"".concat(u," left-[75%]")})]}),!c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.HH,{type:"source",position:o.Ly.Bottom,className:"".concat(u," left-[25%]")}),(0,s.jsx)(o.HH,{type:"source",position:o.Ly.Bottom,className:"".concat(u," left-[75%]")})]}),!d&&(0,s.jsx)("div",{className:"absolute -top-3 -right-3 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(Badge,{variant:"destructive",className:"cursor-pointer animate-pulse",children:"Double-click to delete"})}),(0,s.jsx)(j,{className:"p-4 pb-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(t,{className:"w-4 h-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold",children:a.label||r})]}),(0,s.jsx)(Badge,{variant:"secondary",className:"bg-secondary/50",children:i})]})}),(0,s.jsxs)(C,{className:"p-4 pt-2",children:[n,void 0!==a.prompt&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(T,{placeholder:"Enter your prompt here...",value:a.prompt||"",onChange:e=>{l&&l({...a,prompt:e.target.value})},className:"min-h-[80px] text-xs font-mono resize-none bg-background/50"})}),a.file&&(0,s.jsx)("div",{className:"mt-2 p-2 bg-muted rounded-md",children:(0,s.jsxs)("p",{className:"text-xs font-mono truncate",children:["\uD83D\uDCCE ",a.file.name]})})]})]})},D=(0,r.memo)(e=>{let{data:a,id:t}=e,{setNodes:r}=(0,o._K)();return(0,s.jsx)(BaseNode,{data:a,icon:d.Z,label:"Text Generation",badgeText:"Text",updateNodeData:e=>{r(a=>a.map(a=>a.id===t?{...a,data:{...a.data,...e}}:a))},children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.description})})});D.displayName="TextGenerationNode";var _=t(6691),L=t.n(_);let S=(0,r.memo)(e=>{let{data:a,id:t}=e,{setNodes:r}=(0,o._K)();return(0,s.jsxs)(BaseNode,{data:a,icon:c.Z,label:"Image Generation",badgeText:"Image",updateNodeData:e=>{r(a=>a.map(a=>a.id===t?{...a,data:{...a.data,...e}}:a))},children:[a.image&&(0,s.jsx)("div",{className:"relative h-32 w-full mb-3 rounded-md overflow-hidden",children:(0,s.jsx)(L(),{src:a.image,alt:a.label,fill:!0,className:"object-cover"})}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description})]})});S.displayName="ImageGenerationNode";var R=t(2549);function FilePreview(e){let{file:a,onRemove:t}=e,r=a.type.startsWith("image/");return(0,s.jsx)("div",{className:"relative mt-2 p-2 bg-muted rounded-md group",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[r?(0,s.jsx)("div",{className:"relative h-20 w-20 rounded-md overflow-hidden",children:(0,s.jsx)(L(),{src:a.data,alt:a.name,fill:!0,className:"object-cover"})}):(0,s.jsx)(m.Z,{className:"h-20 w-20 p-4 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium truncate",children:a.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:r?"Image":"Document"})]}),t&&(0,s.jsx)(f.z,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:t,children:(0,s.jsx)(R.Z,{className:"h-4 w-4"})})]})})}let O=(0,r.memo)(e=>{let{data:a,id:t}=e,{setNodes:i}=(0,o._K)(),updateNodeData=e=>{i(a=>a.map(a=>a.id===t?{...a,data:{...a.data,...e}}:a))},n=(0,r.useCallback)(e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(t){let e=new FileReader;e.onload=e=>{var a;updateNodeData({file:{name:t.name,type:t.type,data:null===(a=e.target)||void 0===a?void 0:a.result}})},e.readAsDataURL(t)}},[updateNodeData]),l=(0,r.useCallback)(()=>{updateNodeData({file:null})},[updateNodeData]);return(0,s.jsxs)(BaseNode,{data:a,icon:m.Z,label:"File to Text",badgeText:"File → Text",updateNodeData:updateNodeData,children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:a.file?(0,s.jsx)(FilePreview,{file:a.file,onRemove:l}):(0,s.jsx)(f.z,{variant:"outline",className:"w-full",size:"sm",asChild:!0,children:(0,s.jsxs)("label",{className:"cursor-pointer",children:[(0,s.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),"Upload File",(0,s.jsx)("input",{type:"file",className:"hidden",onChange:n,accept:".txt,.pdf,.doc,.docx"})]})})})]})});O.displayName="FileToTextNode";let I=(0,r.memo)(e=>{let{data:a,id:t}=e,{setNodes:i}=(0,o._K)(),updateNodeData=e=>{i(a=>a.map(a=>a.id===t?{...a,data:{...a.data,...e}}:a))},n=(0,r.useCallback)(e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(t){let e=new FileReader;e.onload=e=>{var a;updateNodeData({file:{name:t.name,type:t.type,data:null===(a=e.target)||void 0===a?void 0:a.result}})},e.readAsDataURL(t)}},[updateNodeData]),l=(0,r.useCallback)(()=>{updateNodeData({file:null})},[updateNodeData]);return(0,s.jsxs)(BaseNode,{data:a,icon:u.Z,label:"Image to Text",badgeText:"Text",updateNodeData:updateNodeData,children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:a.file?(0,s.jsx)(FilePreview,{file:a.file,onRemove:l}):(0,s.jsx)(f.z,{variant:"outline",className:"w-full",size:"sm",asChild:!0,children:(0,s.jsxs)("label",{className:"cursor-pointer",children:[(0,s.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),"Upload Image",(0,s.jsx)("input",{type:"file",className:"hidden",onChange:n,accept:"image/*"})]})})})]})});I.displayName="ImageToTextNode";var G=t(7444);let z=(0,r.memo)(e=>{let{data:a,id:t}=e,{setNodes:r}=(0,o._K)();return(0,s.jsx)(BaseNode,{data:a,icon:G.Z,label:"Output",badgeText:"Result",updateNodeData:e=>{r(a=>a.map(a=>a.id===t?{...a,data:{...a.data,...e}}:a))},isOutput:!0,hideBottomHandles:!0,singleTarget:!0,children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description}),(0,s.jsx)("div",{className:(0,h.cn)("mt-2 rounded-md border",!a.output&&"border-dashed h-32 flex items-center justify-center"),children:a.output?"image"===a.outputType?(0,s.jsx)("div",{className:"relative h-32 w-full rounded-md overflow-hidden",children:(0,s.jsx)(L(),{src:a.output,alt:"Generated output",fill:!0,className:"object-cover"})}):(0,s.jsx)("div",{className:"p-3 font-mono text-sm whitespace-pre-wrap",children:a.output}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Output will appear here"})})]})})});z.displayName="OutputNode";var Z=t(8712);let E=Z.fC,A=Z.xz,B=Z.h_;Z.x8;let M=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(Z.aV,{ref:a,className:(0,h.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});M.displayName=Z.aV.displayName;let W=r.forwardRef((e,a)=>{let{className:t,children:r,...o}=e;return(0,s.jsxs)(B,{children:[(0,s.jsx)(M,{}),(0,s.jsxs)(Z.VY,{ref:a,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o,children:[r,(0,s.jsxs)(Z.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(R.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});W.displayName=Z.VY.displayName;let DialogHeader=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};DialogHeader.displayName="DialogHeader";let F=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(Z.Dx,{ref:a,className:(0,h.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});F.displayName=Z.Dx.displayName;let H=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(Z.dk,{ref:a,className:(0,h.cn)("text-sm text-muted-foreground",t),...r})});H.displayName=Z.dk.displayName;let U=r.forwardRef((e,a)=>{let{className:t,type:r,...o}=e;return(0,s.jsx)("input",{type:r,className:(0,h.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...o})});U.displayName="Input";var J=t(9409);function WorkflowMetadata(e){let{metadata:a,onUpdate:t}=e,[o,i]=(0,r.useState)(a);return(0,s.jsxs)(E,{children:[(0,s.jsx)(A,{asChild:!0,children:(0,s.jsxs)(f.z,{variant:"ghost",size:"sm",className:"gap-2",children:[(0,s.jsx)(J.Z,{className:"h-4 w-4"}),a.name||"Untitled Workflow"]})}),(0,s.jsxs)(W,{className:"sm:max-w-[425px]",children:[(0,s.jsx)(DialogHeader,{children:(0,s.jsx)(F,{children:"Workflow Settings"})}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"name",className:"text-sm font-medium",children:"Workflow Name"}),(0,s.jsx)(U,{id:"name",value:o.name,onChange:e=>i(a=>({...a,name:e.target.value})),placeholder:"Enter workflow name..."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),(0,s.jsx)(T,{id:"description",value:o.description,onChange:e=>i(a=>({...a,description:e.target.value})),placeholder:"Describe your workflow...",className:"resize-none",rows:3})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Created: ",new Date(a.created).toLocaleString()]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Last modified: ",new Date(a.updated).toLocaleString()]})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(f.z,{onClick:()=>{t({...o,updated:new Date().toISOString()})},children:"Save Changes"})})]})]})}var X=t(5004);let RANDOM_INT=(e,a)=>Math.floor(Math.random()*(a-e+1)+e),V={init:{scale:1,boxShadow:"0 0 0rem 0rem rgba(66, 18, 161, 0)",outline:"7px solid rgba(129, 75, 255, 0)",background:"radial-gradient(70% 90% at 50% 100%, rgb(31, 30, 31) 0%, rgb(31, 30, 31) 100%)",transition:{ease:[.33,1,.68,1],duration:.3}},anim:{scale:1,boxShadow:"0 0 20rem 5rem rgba(65, 18, 161, 1), 0 2px 0 0 rgb(120, 54, 250) inset, 0 -2px 0 0 rgb(86, 4, 250) inset",outline:"7px solid rgba(137, 87, 255, 0.2)",background:"radial-gradient(70% 100% at 50% 110%, #b37afd 0%, rgb(77, 19, 212) 100%)",transition:{type:"spring",bounce:.25,duration:.5}},tap:{scale:1}},K={init:{background:"linear-gradient(90deg, rgb(117, 117, 117) 0%, rgb(80, 78, 80) 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",transition:{ease:[.33,1,.68,1],duration:.5}},anim:{background:"linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)",transition:{ease:[.33,1,.68,1],duration:1}}},P={init:{},anim:{transition:{staggerChildren:.2,delayChildren:1}}},Y={init:e=>({fill:"rgb(255, 255, 255)",opacity:(3-e+1)/4,transition:{duration:.6}}),anim:e=>({opacity:[null,.5,1,1===e?1:(3-e+1)/4],scale:[null,.5,1.3,1],transition:{duration:.6,repeatDelay:2.2,repeat:1/0}})},$={init:{scaleY:1,scaleX:1,transition:{ease:"linear",duration:.001}},anim:{scaleY:[null,-1],scaleX:[null,-1],transition:{ease:"linear",duration:.001,delay:1.3,repeatDelay:1.3,repeatType:"reverse",repeat:1/0}}},Q={init:{rotateZ:-65,transition:{ease:"linear",duration:.001}},anim:{rotateZ:[null,65],transition:{ease:[.5,1,.89,1],duration:1.3,repeat:1/0}}},q={init:e=>({rotateZ:0,opacity:0,scale:0,top:"calc(".concat(RANDOM_INT(3,9)," * 10%)"),left:"calc(".concat(RANDOM_INT(3,9)," * 10%)"),width:"calc(".concat(RANDOM_INT(3,9)/10," * 14px)"),transformOrigin:"".concat(Math.random()>.5?-10*RANDOM_INT(30,80):10*RANDOM_INT(30,80),"% ").concat(Math.random()>.5?-10*RANDOM_INT(30,80):10*RANDOM_INT(30,80),"%"),transition:{duration:.5}}),anim:e=>({scale:1,rotateZ:e%2==0?[0,360]:[-360,0],opacity:RANDOM_INT(5,8)/10,transition:{opacity:{duration:1,ease:"anticipate"},scale:{duration:2,ease:"anticipate"},ease:"linear",delay:-1*RANDOM_INT(1,10),duration:RANDOM_INT(10,25),repeat:1/0}})};var ee=t(8716),ea=t.n(ee),components_Sparkles=e=>{let{sparkles:a,hover:t}=e;return(0,s.jsx)(X.E.div,{initial:"init",animate:t?"anim":"init",className:ea().sparkleContainer,children:a.map((e,a)=>(0,s.jsx)(X.E.svg,{variants:q,custom:a,viewBox:"0 0 12 13",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)(X.E.path,{animate:{rotate:360},d:"M6.657 1.247C6.767 0.917 7.233 0.917 7.343 1.247L7.988 3.184C8.12997 3.6098 8.36917 3.99668 8.68664 4.31398C9.00411 4.63127 9.39112 4.87026 9.817 5.012L11.753 5.657C12.083 5.767 12.083 6.233 11.753 6.343L9.816 6.988C9.3902 7.12997 9.00332 7.36917 8.68602 7.68664C8.36873 8.00411 8.12974 8.39112 7.988 8.817L7.343 10.753C7.31929 10.8253 7.27335 10.8882 7.21176 10.9328C7.15016 10.9774 7.07605 11.0014 7 11.0014C6.92395 11.0014 6.84984 10.9774 6.78824 10.9328C6.72665 10.8882 6.68072 10.8253 6.657 10.753L6.012 8.816C5.87013 8.39031 5.63108 8.00349 5.31379 7.68621C4.99651 7.36892 4.60969 7.12987 4.184 6.988L2.247 6.343C2.17474 6.31928 2.11181 6.27335 2.0672 6.21176C2.02259 6.15016 1.99857 6.07605 1.99857 6C1.99857 5.92395 2.02259 5.84983 2.0672 5.78824C2.11181 5.72665 2.17474 5.68072 2.247 5.657L4.184 5.012C4.60969 4.87013 4.99651 4.63108 5.31379 4.31379C5.63108 3.99651 5.87013 3.60969 6.012 3.184L6.657 1.247Z"})},a))})},components_Stars=e=>{let{hover:a}=e;return(0,s.jsxs)(X.E.svg,{variants:P,viewBox:"0 0 12 13",fill:"none",xmlns:"http://www.w3.org/2000/svg",animate:a?"anim":"init",children:[(0,s.jsx)(X.E.path,{variants:Y,custom:1,d:"M6.657 1.247C6.767 0.917 7.233 0.917 7.343 1.247L7.988 3.184C8.12997 3.6098 8.36917 3.99668 8.68664 4.31398C9.00411 4.63127 9.39112 4.87026 9.817 5.012L11.753 5.657C12.083 5.767 12.083 6.233 11.753 6.343L9.816 6.988C9.3902 7.12997 9.00332 7.36917 8.68602 7.68664C8.36873 8.00411 8.12974 8.39112 7.988 8.817L7.343 10.753C7.31929 10.8253 7.27335 10.8882 7.21176 10.9328C7.15016 10.9774 7.07605 11.0014 7 11.0014C6.92395 11.0014 6.84984 10.9774 6.78824 10.9328C6.72665 10.8882 6.68072 10.8253 6.657 10.753L6.012 8.816C5.87013 8.39031 5.63108 8.00349 5.31379 7.68621C4.99651 7.36892 4.60969 7.12987 4.184 6.988L2.247 6.343C2.17474 6.31928 2.11181 6.27335 2.0672 6.21176C2.02259 6.15016 1.99857 6.07605 1.99857 6C1.99857 5.92395 2.02259 5.84983 2.0672 5.78824C2.11181 5.72665 2.17474 5.68072 2.247 5.657L4.184 5.012C4.60969 4.87013 4.99651 4.63108 5.31379 4.31379C5.63108 3.99651 5.87013 3.60969 6.012 3.184L6.657 1.247Z"}),(0,s.jsx)(X.E.path,{variants:Y,custom:2,d:"M2.39415 8.03423C2.36334 8.05648 2.34032 8.08788 2.32838 8.12396L2.00596 9.09204C1.93505 9.30488 1.81554 9.49828 1.65691 9.65691C1.49828 9.81554 1.30488 9.93505 1.09204 10.006L0.123957 10.3284C0.0878781 10.3403 0.0564822 10.3633 0.0342297 10.3941C0.0119772 10.425 0 10.462 0 10.5C0 10.538 0.0119772 10.575 0.0342297 10.6059C0.0564822 10.6367 0.0878781 10.6597 0.123957 10.6716L1.09204 10.994C1.30488 11.0649 1.49828 11.1845 1.65691 11.3431C1.81554 11.5017 1.93505 11.6951 2.00596 11.908L2.32838 12.876C2.34032 12.9121 2.36334 12.9435 2.39415 12.9658C2.42496 12.988 2.46199 13 2.5 13C2.538 13 2.57504 12.988 2.60585 12.9658C2.63666 12.9435 2.65967 12.9121 2.67162 12.876L2.99404 11.908C3.06495 11.6951 3.18446 11.5017 3.34309 11.3431C3.50172 11.1845 3.69512 11.0649 3.90796 10.994L4.87604 10.6716C4.91212 10.6597 4.94352 10.6367 4.96577 10.6059C4.98802 10.575 5 10.538 5 10.5C5 10.462 4.98802 10.425 4.96577 10.3941C4.94352 10.3633 4.91212 10.3403 4.87604 10.3284L3.90796 10.006C3.47641 9.86183 3.13817 9.52359 2.99404 9.09204L2.67162 8.12396C2.65967 8.08788 2.63666 8.05648 2.60585 8.03423C2.57504 8.01198 2.538 8 2.5 8C2.46199 8 2.42496 8.01198 2.39415 8.03423Z"}),(0,s.jsx)(X.E.path,{variants:Y,custom:3,d:"M2.4365 0.0201631C2.41807 0.0332787 2.40418 0.0518105 2.39677 0.0731818L2.20383 0.654117C2.11749 0.913811 1.91404 1.11721 1.65428 1.20353L1.0732 1.39717C1.05182 1.40458 1.03329 1.41847 1.02017 1.4369C1.00705 1.45532 1 1.47738 1 1.5C1 1.52262 1.00705 1.54468 1.02017 1.5631C1.03329 1.58153 1.05182 1.59542 1.0732 1.60283L1.65353 1.79647C1.78154 1.83905 1.89786 1.91087 1.99326 2.00624C2.08865 2.10161 2.16049 2.2179 2.20308 2.34588L2.39677 2.92682C2.40418 2.94819 2.41807 2.96672 2.4365 2.97984C2.45494 2.99295 2.477 3 2.49962 3C2.52225 3 2.54431 2.99295 2.56275 2.97984C2.58118 2.96672 2.59507 2.94819 2.60248 2.92682L2.79617 2.34588C2.83876 2.2179 2.9106 2.10161 3.00599 2.00624C3.10139 1.91087 3.21771 1.83905 3.34572 1.79647L3.9268 1.60283C3.94818 1.59542 3.96671 1.58153 3.97983 1.5631C3.99295 1.54468 4 1.52262 4 1.5C4 1.47738 3.99295 1.45532 3.97983 1.4369C3.96671 1.41847 3.94818 1.40458 3.9268 1.39717L3.34572 1.20353C3.08596 1.11721 2.88251 0.913811 2.79617 0.654117L2.60248 0.0731818C2.59507 0.0518105 2.58118 0.0332787 2.56275 0.0201631C2.54431 0.00704757 2.52225 0 2.49962 0C2.477 0 2.45494 0.00704757 2.4365 0.0201631Z"})]})},framer_ai_button_AIButton=e=>{let{children:a="Generate",hueValue:t=0,...o}=e,[i,n]=(0,r.useState)(!1),[l]=(0,r.useState)(Array(30).fill(0));return(0,s.jsxs)("div",{style:{position:"relative"},children:[(0,s.jsx)(components_Sparkles,{sparkles:l,hover:i}),(0,s.jsxs)(X.E.button,{...o,variants:V,initial:"init",animate:i?"anim":"init",whileTap:"tap",onHoverStart:()=>n(!0),onHoverEnd:()=>n(!1),className:ea().btn,type:"button",style:{filter:"hue-rotate(".concat(t,"deg)")},children:[(0,s.jsx)(X.E.div,{"data-testid":"highlight",variants:$,className:ea().highlightContainer,animate:i?"anim":"init",children:(0,s.jsx)(X.E.div,{variants:Q,className:ea().highlight})}),(0,s.jsx)(components_Stars,{hover:i}),(0,s.jsx)(X.E.span,{variants:K,children:a})]})]})};let et=[{id:"output",type:"outputNode",position:{x:250,y:300},data:{label:"Output",type:"output",description:"Final workflow result",outputType:"text",output:""}}],es={animated:!0,markerEnd:{type:o.QZ.ArrowClosed,color:"currentColor"},style:{strokeWidth:2}},er="workflow-builder-state",eo={hideAttribution:!0},ei={name:"Untitled Workflow",description:"Custom AI workflow configuration",created:new Date().toISOString(),updated:new Date().toISOString()},en={textGenerationNode:D,imageGenerationNode:S,fileToTextNode:O,imageToTextNode:I,outputNode:z};function WorkflowBuilder(){let e=(0,r.useRef)(null),[a,t,h]=(0,o.Rr)(et),[N,j,b]=(0,o.ll)([]),[v,C]=(0,r.useState)(ei),[w,y]=(0,r.useState)(null),[k,T]=(0,r.useState)(!1),D=(0,r.useRef)(!0),[_,L]=(0,r.useState)(null),[S,R]=(0,r.useState)([]),[O,I]=(0,r.useState)(!1),[G,z]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=localStorage.getItem(er);if(e)try{let{nodes:a,edges:s,metadata:r}=JSON.parse(e);t(a),j(s),r&&C(r)}catch(e){console.error("Error loading saved state:",e)}},[]),(0,r.useEffect)(()=>{if(D.current){D.current=!1;return}try{localStorage.setItem(er,JSON.stringify({nodes:a,edges:N,metadata:v}))}catch(e){console.error("Error saving state:",e)}},[a,N,v]),(0,r.useCallback)((e,a)=>{t(t=>t.map(t=>t.id===e?{...t,data:{...t.data,...a}}:t))},[t]);let Z=(0,r.useCallback)(e=>{C(e)},[]),E=(0,r.useCallback)(e=>{var t;let s=a.find(a=>a.id===e.source),r=a.find(a=>a.id===e.target);if(!s||!r||e.source===e.target)return!1;if("outputNode"===r.type){let e=N.find(e=>e.target===r.id);if(e)return!1}return(null===(t=({textGenerationNode:["textGenerationNode","imageGenerationNode","outputNode"],imageGenerationNode:["imageToTextNode","imageGenerationNode","outputNode"],fileToTextNode:["textGenerationNode","imageGenerationNode","outputNode"],imageToTextNode:["textGenerationNode","imageGenerationNode","outputNode"]})[s.type||0])||void 0===t?void 0:t.includes(r.type))||!1},[a,N]),A=(0,r.useCallback)(e=>{E(e)&&j(a=>{let t=a.some(a=>a.source===e.source&&a.target===e.target);return!t&&e.source&&e.target?(0,o.Z_)({...e,type:"default",id:"e".concat(e.source,"-").concat(e.target),className:"animate-pulse"},a):a})},[j,E]),B=(0,r.useCallback)((e,a)=>{j(e=>e.filter(e=>e.id!==a.id))},[j]),M=(0,r.useCallback)((e,a)=>{"outputNode"!==a.type&&(t(e=>e.filter(e=>e.id!==a.id)),j(e=>e.filter(e=>e.source!==a.id&&e.target!==a.id)))},[t,j]),W=(0,r.useCallback)(e=>{let s={id:"".concat(e,"-").concat(a.length+1),type:e,position:{x:500*Math.random(),y:300*Math.random()},data:{label:"".concat("textGenerationNode"===e?"Text Generation":"imageGenerationNode"===e?"Image Generation":"fileToTextNode"===e?"File to Text":"Image to Text"," ").concat(a.length),type:e.replace("Node",""),description:"Configure this ".concat("textGenerationNode"===e?"text generation":"imageGenerationNode"===e?"image generation":"fileToTextNode"===e?"file to text":"image to text"," node"),prompt:"",outputType:"imageGenerationNode"===e?"image":"text",inputType:e.startsWith("file")?"file":e.startsWith("image")?"image":"text"}};t(e=>[...e,s])},[a.length,t]),F=(0,r.useCallback)(()=>{let e=new Blob([JSON.stringify({nodes:a,edges:N,metadata:v},null,2)],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="".concat(v.name.toLowerCase().replace(/\s+/g,"-"),".json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},[a,N,v]),H=(0,r.useCallback)(e=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];if(s){let e=new FileReader;e.onload=e=>{try{var a;let s=null===(a=e.target)||void 0===a?void 0:a.result,r=JSON.parse(s);t(r.nodes),j(r.edges),r.metadata&&C(r.metadata)}catch(e){console.error("Error importing workflow:",e)}},e.readAsText(s)}},[t,j,C]),U=(0,r.useCallback)(async()=>{T(!0),y(null);try{let e=await fetch("/api/workflow/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodes:a,edges:N,metadata:v})}),t=await e.json();y(t)}catch(e){y({success:!1,error:e.message})}finally{T(!1)}},[a,N,v]),saveWorkflow=async()=>{L(null);try{let e=await fetch("/api/workflow/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:v.name||"Untitled Workflow",data:{nodes:a,edges:N,metadata:v}})}),t=await e.json();t.success?L("Saved!"):L(t.error||"Save failed")}catch(e){L("Save failed")}},loadWorkflows=async()=>{I(!0),z(!0);try{let e=await fetch("/api/workflow/load"),a=await e.json();a.success&&R(a.workflows)}finally{I(!1)}};return(0,s.jsxs)("div",{className:"h-full w-full",ref:e,children:[(0,s.jsxs)(o.x$,{nodes:a,edges:N,onNodesChange:h,onEdgesChange:b,onConnect:A,onEdgeDoubleClick:B,onNodeDoubleClick:M,nodeTypes:en,defaultEdgeOptions:es,connectionMode:o.jD.Loose,fitView:!0,className:"bg-[radial-gradient(circle_at_center,_var(--background)_0%,_var(--muted)_100%)]",snapToGrid:!0,snapGrid:[20,20],proOptions:eo,children:[(0,s.jsx)(i.A,{color:"currentColor",className:"opacity-[0.02]"}),(0,s.jsx)(n.Z,{className:"bg-background border shadow-md"}),(0,s.jsx)(o.s_,{position:"top-left",className:"flex gap-2",children:(0,s.jsx)(WorkflowMetadata,{metadata:v,onUpdate:Z})}),(0,s.jsxs)(o.s_,{position:"top-right",className:"flex gap-2",children:[(0,s.jsx)(framer_ai_button_AIButton,{onClick:U,disabled:k}),(0,s.jsxs)(g.h_,{children:[(0,s.jsx)(g.$F,{asChild:!0,children:(0,s.jsxs)(f.z,{size:"sm",variant:"secondary",className:"shadow-md text-sm",children:[(0,s.jsx)(l.Z,{className:"mr-2 h-4 w-4"}),"Add Node"]})}),(0,s.jsxs)(g.AW,{children:[(0,s.jsxs)(g.Xi,{onClick:()=>W("textGenerationNode"),children:[(0,s.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"Text Generation"]}),(0,s.jsxs)(g.Xi,{onClick:()=>W("imageGenerationNode"),children:[(0,s.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Image Generation"]}),(0,s.jsxs)(g.Xi,{onClick:()=>W("fileToTextNode"),children:[(0,s.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"File to Text"]}),(0,s.jsxs)(g.Xi,{onClick:()=>W("imageToTextNode"),children:[(0,s.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Image to Text"]})]})]}),(0,s.jsxs)(f.z,{onClick:F,size:"sm",variant:"secondary",className:"shadow-md",children:[(0,s.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,s.jsx)(f.z,{onClick:saveWorkflow,size:"sm",variant:"secondary",className:"shadow-md",children:"Save Workflow"}),_&&(0,s.jsx)("span",{className:"ml-2 text-xs",children:_}),(0,s.jsx)(f.z,{onClick:loadWorkflows,size:"sm",variant:"secondary",className:"shadow-md",children:"Load Workflows"}),(0,s.jsx)(f.z,{size:"sm",variant:"secondary",className:"shadow-md",asChild:!0,children:(0,s.jsxs)("label",{children:[(0,s.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Import",(0,s.jsx)("input",{type:"file",className:"hidden",accept:".json",onChange:H})]})})]})]}),w&&(0,s.jsxs)("div",{className:"fixed bottom-4 right-4 bg-background border shadow-lg p-4 rounded-md z-50 max-w-md",children:[(0,s.jsx)("h4",{className:"font-bold mb-2",children:"Workflow Result"}),(0,s.jsx)("pre",{className:"text-xs whitespace-pre-wrap break-all",children:JSON.stringify(w,null,2)})]}),G&&(0,s.jsxs)("div",{className:"fixed top-20 right-4 bg-white border shadow-lg p-4 rounded-md z-50 max-w-md",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("h4",{className:"font-bold",children:"Your Workflows"}),(0,s.jsx)("button",{onClick:()=>z(!1),className:"text-gray-500 hover:text-black",children:"✕"})]}),O?(0,s.jsx)("div",{children:"Loading..."}):S.length>0?(0,s.jsx)("ul",{children:S.map(e=>(0,s.jsxs)("li",{className:"mb-2",children:[(0,s.jsx)("button",{className:"underline text-blue-600",onClick:()=>{t(e.data.nodes),j(e.data.edges),C(e.data.metadata),z(!1)},children:e.name}),(0,s.jsx)("span",{className:"ml-2 text-xs text-gray-400",children:new Date(e.updatedAt).toLocaleString()})]},e.id))}):(0,s.jsx)("div",{children:"No workflows found."})]})]})}},8716:function(e){e.exports={btn:"Button_btn__9DVow",highlightContainer:"Button_highlightContainer__OAn94",highlight:"Button_highlight__JXf8z",sparkleContainer:"Button_sparkleContainer__KX2fp"}}}]);